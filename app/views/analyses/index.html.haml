%h1 Listing analyses

%table.table.table-striped

  = table_headers(Analysis, [:research_question, :dataset, :created_at, :possible_models, :remaining_questions,:user], include_actions: true)

  %tbody
    - @analyses.each do |analysis|
      %tr{data:{href: analysis_path(analysis)}}
        %td= analysis.research_question.name
        %td= analysis.dataset.name
        %td= l(analysis.created_at, format: :short)
        %td= analysis.possible_models.count
        %td= analysis.query_assumption_results.where(result:nil, ignore:false).count
        = user_td(analysis)
        %td
          = link_icon_to 'trash',analysis, method: :delete, data:{confirm: 'Are you sure?'},title: "Delete", class: 'btn-xs btn-danger' if can? :destroy, analysis
.help-block
  - if current_user.is_statistician?
    You can see analyses generated by you and other users.
  -else
    You only see analyses that you have created.
= link_icon_to 'plus',new_analysis_path, class: 'btn-success pull-right', text: 'Start new analysis' if can? :create, Analysis
